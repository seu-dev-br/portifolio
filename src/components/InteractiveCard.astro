---
import OptimizedImage from './OptimizedImage.astro';

// InteractiveCard.astro - Card com micro-interações aprimoradas
export interface Props {
	title: string;
	description?: string;
	image?: string;
	icon?: string;
	href?: string;
	target?: '_blank' | '_self';
	variant?: 'default' | 'featured' | 'minimal';
	size?: 'sm' | 'md' | 'lg';
	gradient?: string;
	children?: any;
}

const {
	title,
	description,
	image,
	icon,
	href,
	target = '_self',
	variant = 'default',
	size = 'md',
	gradient = 'from-primary-500 to-accent-cyan',
	children
} = Astro.props;

const sizeClasses = {
	sm: 'p-4',
	md: 'p-6',
	lg: 'p-8'
};

const variantClasses = {
	default: 'bg-gray-800/50 backdrop-blur-sm border border-gray-700/50',
	featured: `bg-gradient-to-br ${gradient} border-0`,
	minimal: 'bg-transparent border border-gray-700/30 hover:border-gray-600/50'
};

const Component = href ? 'a' : 'div';
const componentProps = href ? { href, target, rel: target === '_blank' ? 'noopener noreferrer' : undefined } : {};
---

<Component
	{...componentProps}
	class={`interactive-card group relative overflow-hidden rounded-xl card-hover cursor-pointer ${sizeClasses[size]} ${variantClasses[variant]} ${href ? '' : ''}`}
>
	<!-- Background gradient overlay for featured variant -->
	{variant === 'featured' && (
		<div class="absolute inset-0 bg-gradient-to-br from-black/20 to-black/40"></div>
	)}

	<!-- Hover glow effect -->
	<div class="absolute inset-0 bg-gradient-to-r from-primary-500/0 via-primary-500/5 to-accent-cyan/0 opacity-0 group-hover:opacity-100 transition-opacity duration-500 rounded-xl"></div>

	<!-- Content -->
	<div class="relative z-10">
		<!-- Image/Icon -->
		{(image || icon) && (
			<div class="mb-4 transform transition-transform duration-300 group-hover:scale-110">
				{image ? (
					   <OptimizedImage
						   src={image}
						   alt={title}
						   width={800}
						   height={400}
						   class="w-full h-48 object-cover rounded-lg transition-all duration-300 group-hover:brightness-110"
					   />
				) : (
					<div class="w-16 h-16 bg-gradient-to-r from-primary-500 to-accent-cyan rounded-xl flex items-center justify-center mx-auto mb-4 group-hover:rotate-12 transition-transform duration-300">
						<div class="w-8 h-8 text-white" set:html={icon}></div>
					</div>
				)}
			</div>
		)}

		<!-- Title -->
		<h3 class={`font-bold mb-2 transition-colors duration-300 ${
			variant === 'featured' ? 'text-white' : 'text-white group-hover:text-primary-400'
		}`}>
			{title}
		</h3>

		<!-- Description -->
		{description && (
			<p class={`text-sm leading-relaxed transition-colors duration-300 ${
				variant === 'featured' ? 'text-gray-200' : 'text-gray-400 group-hover:text-gray-300'
			}`}>
				{description}
			</p>
		)}

		<!-- Custom content -->
		{children && (
			<div class="mt-4">
				{children}
			</div>
		)}

		<!-- Hover indicator -->
		{href && (
			<div class="absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-all duration-300 transform translate-x-2 group-hover:translate-x-0">
				<svg class="w-5 h-5 text-primary-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
					<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
				</svg>
			</div>
		)}
	</div>

	<!-- Animated border -->
	<div class="absolute inset-0 rounded-xl border-2 border-transparent group-hover:border-primary-500/50 transition-all duration-500 opacity-0 group-hover:opacity-100"></div>
</Component>

<style>
	.interactive-card {
		transform-style: preserve-3d;
	}

	.interactive-card::before {
		content: '';
		position: absolute;
		inset: -2px;
		border-radius: inherit;
		padding: 2px;
		background: linear-gradient(45deg, transparent, rgba(59, 130, 246, 0.3), transparent);
		background-size: 200% 200%;
		opacity: 0;
		transition: opacity 0.5s ease;
		z-index: -1;
	}

	.interactive-card:hover::before {
		opacity: 1;
		animation: rotate 3s linear infinite;
	}

	@keyframes rotate {
		0% { background-position: 0% 50%; }
		50% { background-position: 100% 50%; }
		100% { background-position: 0% 50%; }
	}

	/* Focus enhancement */
	.interactive-card:focus-visible {
		outline: 2px solid rgb(59, 130, 246);
		outline-offset: 4px;
	}
</style>
