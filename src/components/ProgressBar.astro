---
// ProgressBar.astro - Barra de progresso com animações
export interface Props {
	progress?: number;
	size?: 'sm' | 'md' | 'lg';
	variant?: 'default' | 'gradient' | 'striped';
	showPercentage?: boolean;
	label?: string;
	animated?: boolean;
}

const {
	progress = 0,
	size = 'md',
	variant = 'default',
	showPercentage = false,
	label,
	animated = true
} = Astro.props;

const sizeClasses = {
	sm: 'h-1',
	md: 'h-2',
	lg: 'h-3'
};

const variantClasses = {
	default: 'bg-primary-500',
	gradient: 'bg-gradient-to-r from-primary-500 to-accent-cyan',
	striped: 'bg-primary-500 striped-progress'
};
---

<div class="progress-container w-full">
	<!-- Label -->
	{label && (
		<div class="flex justify-between items-center mb-2">
			<span class="text-sm font-medium text-gray-300">{label}</span>
			{showPercentage && (
				<span class="text-sm text-gray-400">{Math.round(progress)}%</span>
			)}
		</div>
	)}

	<!-- Progress Bar Container -->
	<div class={`progress-bar-container bg-gray-700/50 rounded-full overflow-hidden ${sizeClasses[size]}`}>
		<div
			class={`progress-bar ${variantClasses[variant]} rounded-full transition-all duration-500 ease-out ${animated ? 'animate-pulse' : ''}`}
			style={`width: ${Math.min(100, Math.max(0, progress))}%`}
		></div>
	</div>
</div>

<style>
	.progress-bar-container {
		position: relative;
	}

	.progress-bar {
		position: relative;
		transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
	}

	.striped-progress {
		background-image: linear-gradient(
			45deg,
			rgba(255, 255, 255, 0.1) 25%,
			transparent 25%,
			transparent 50%,
			rgba(255, 255, 255, 0.1) 50%,
			rgba(255, 255, 255, 0.1) 75%,
			transparent 75%,
			transparent
		);
		background-size: 20px 20px;
		animation: stripe-move 1s linear infinite;
	}

	@keyframes stripe-move {
		0% { background-position: 0 0; }
		100% { background-position: 20px 0; }
	}

	/* Glow effect for gradient variant */
	.progress-bar-container:has(.bg-gradient-to-r) {
		box-shadow: 0 0 10px rgba(59, 130, 246, 0.3);
	}

	/* Completion animation */
	.progress-bar[style*="width: 100%"] {
		animation: complete 0.6s ease-out;
	}

	@keyframes complete {
		0% { transform: scaleY(1); }
		50% { transform: scaleY(1.2); }
		100% { transform: scaleY(1); }
	}
</style>
